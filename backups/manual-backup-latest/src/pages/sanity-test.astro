---
/**
 * Sanity CMS Integration Test Page
 * Accessible at /sanity-test to verify CMS connection and ad fetching
 */

import MainLayout from '../layouts/MainLayout.astro';
import SanityIntegrationTest from '../components/SanityIntegrationTest.astro';
import UniversalPromo from '../components/UniversalPromo.astro';

const title = 'Sanity CMS Integration Test';
const description = 'Testing Sanity CMS integration for dynamic partner content management';
---

<MainLayout title={title} description={description}>
  <main class="test-page">
    <div class="container">
      <header class="page-header">
        <h1>üîó Sanity CMS Integration Test</h1>
        <p>This page tests the integration between our AI News Site and Sanity CMS for dynamic partner content management.</p>
      </header>

      <!-- Integration Status Test -->
      <section class="test-section">
        <h2>üìä Integration Status</h2>
        <SanityIntegrationTest placement="sidebar-premium-spotlight" />
      </section>

      <!-- Live Ad Rendering Test -->
      <section class="test-section">
        <h2>üéØ Live Partner Content Rendering</h2>
        <p>Testing UniversalPromo components with Sanity CMS integration:</p>
        
        <div class="ad-test-grid">
          <div class="ad-test-item">
            <h3>Sidebar Premium Spotlight</h3>
            <UniversalPromo adId="sidebar-premium-spotlight" />
          </div>
          
          <div class="ad-test-item">
            <h3>Hero Premium Top</h3>
            <UniversalPromo adId="hero-premium-top" />
          </div>
          
          <div class="ad-test-item">
            <h3>Leaderboard Main</h3>
            <UniversalPromo adId="leaderboard-main" />
          </div>
        </div>
      </section>

      <!-- Placement Tests -->
      <section class="test-section">
        <h2>üìç Placement-Specific Tests</h2>
        <div class="placement-tests">
          <SanityIntegrationTest placement="hero-sidebar-top" className="placement-test" />
          <SanityIntegrationTest placement="article-sidebar" className="placement-test" />
          <SanityIntegrationTest placement="category-sidebar" className="placement-test" />
        </div>
      </section>

      <!-- Integration Guide -->
      <section class="test-section">
        <h2>üìñ Integration Guide</h2>
        <div class="guide-content">
          <div class="guide-step">
            <h3>Step 1: Environment Variables</h3>
            <p>Ensure the following environment variables are set in your <code>.env</code> file:</p>
            <pre><code>VITE_SANITY_PROJECT_ID=crtekmb2
VITE_SANITY_DATASET=production
VITE_SANITY_USE_CDN=true
VITE_SANITY_API_VERSION=2024-01-01
VITE_SANITY_TOKEN=your-token-here</code></pre>
          </div>
          
          <div class="guide-step">
            <h3>Step 2: Sanity Studio Setup</h3>
            <p>Run the following commands to set up Sanity Studio:</p>
            <pre><code>npm run sanity:dev</code></pre>
            <p>This will start Sanity Studio at <code>http://localhost:3333</code></p>
          </div>
          
          <div class="guide-step">
            <h3>Step 3: Create Partner Content</h3>
            <p>In Sanity Studio, navigate to "üí∞ Partner Content" ‚Üí "Ads" and create your first ad with:</p>
            <ul>
              <li>ID matching your adId (e.g., "sidebar-premium-spotlight")</li>
              <li>Active status set to true</li>
              <li>Appropriate placement and type</li>
            </ul>
          </div>
          
          <div class="guide-step">
            <h3>Step 4: Test Integration</h3>
            <p>Refresh this page to see your Sanity content rendered dynamically!</p>
          </div>
        </div>
      </section>
    </div>
  </main>
</MainLayout>

<style>
.test-page {
  min-height: 100vh;
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  padding: 2rem 0;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1rem;
}

.page-header {
  text-align: center;
  margin-bottom: 3rem;
  padding: 2rem;
  background: rgba(15, 23, 42, 0.8);
  border-radius: 12px;
  border: 1px solid rgba(0, 212, 255, 0.2);
}

.page-header h1 {
  color: #00d4ff;
  font-size: 2.5rem;
  margin: 0 0 1rem 0;
  font-weight: 700;
}

.page-header p {
  color: #cbd5e1;
  font-size: 1.1rem;
  margin: 0;
  max-width: 600px;
  margin: 0 auto;
}

.test-section {
  margin-bottom: 3rem;
  background: rgba(15, 23, 42, 0.6);
  border-radius: 12px;
  padding: 2rem;
  border: 1px solid rgba(71, 85, 105, 0.3);
}

.test-section h2 {
  color: #e2e8f0;
  font-size: 1.5rem;
  margin: 0 0 1.5rem 0;
  font-weight: 600;
}

.ad-test-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  margin-top: 1.5rem;
}

.ad-test-item {
  background: rgba(30, 41, 59, 0.5);
  border-radius: 8px;
  padding: 1.5rem;
  border: 1px solid rgba(71, 85, 105, 0.3);
}

.ad-test-item h3 {
  color: #00d4ff;
  font-size: 1.1rem;
  margin: 0 0 1rem 0;
  font-weight: 600;
}

.placement-tests {
  display: grid;
  gap: 1rem;
}

.placement-test {
  margin: 0;
}

.guide-content {
  display: grid;
  gap: 1.5rem;
}

.guide-step {
  background: rgba(30, 41, 59, 0.5);
  border-radius: 8px;
  padding: 1.5rem;
  border-left: 4px solid #00d4ff;
}

.guide-step h3 {
  color: #00d4ff;
  font-size: 1.1rem;
  margin: 0 0 1rem 0;
  font-weight: 600;
}

.guide-step p {
  color: #cbd5e1;
  margin: 0.5rem 0;
  line-height: 1.6;
}

.guide-step ul {
  color: #cbd5e1;
  margin: 0.5rem 0;
  padding-left: 1.5rem;
}

.guide-step li {
  margin: 0.25rem 0;
}

.guide-step pre {
  background: rgba(15, 23, 42, 0.8);
  color: #e2e8f0;
  padding: 1rem;
  border-radius: 6px;
  overflow-x: auto;
  font-size: 0.9rem;
  margin: 1rem 0;
}

.guide-step code {
  background: rgba(15, 23, 42, 0.6);
  color: #00d4ff;
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  font-size: 0.9rem;
}

@media (max-width: 768px) {
  .page-header h1 {
    font-size: 2rem;
  }
  
  .ad-test-grid {
    grid-template-columns: 1fr;
  }
  
  .test-section {
    padding: 1.5rem;
  }
  
  .guide-step {
    padding: 1rem;
  }
}
</style>
